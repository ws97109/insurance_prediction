---
name: insurance
description: 基於 DQN 與 XGBoost 的保險交叉銷售預測與客戶價值分群系統
status: backlog
created: 2025-10-09T02:31:16Z
---

# PRD: Insurance AI Prediction System

## Executive Summary

本系統整合深度強化學習 (DQN) 與梯度提升樹 (XGBoost) 技術，為保險公司打造智能化的客戶洞察平台。系統執行雙核心任務：(1) 基於客戶現有保險組合的交叉銷售預測，(2) 基於社會人口統計特徵的客戶價值分群。透過 UCI COIL 2000 資料集訓練的混合模型，預期達成交叉銷售準確率 75%+、客戶分群準確率 85%+，為保險業務團隊提供精準的行銷目標與個人化推薦，提升交叉銷售轉換率 20-30%。

## Problem Statement

### 現有痛點
1. **低效的客戶定向**：保險業務員缺乏數據驅動的客戶洞察，難以識別高價值潛在客戶
2. **盲目的產品推薦**：傳統推薦基於經驗法則，無法針對個別客戶優化產品組合
3. **資源浪費**：行銷資源平均分配導致轉換率低下，ROI 不佳
4. **缺乏預測能力**：無法預測客戶下一步購買意向，錯失交叉銷售機會
5. **客戶分群粗糙**：簡單的人工分群無法捕捉複雜的客戶特徵模式

### 解決方案價值
- **精準行銷**：AI 驅動的客戶價值分群，優先配置資源至高價值客戶
- **智能推薦**：DQN 強化學習持續優化推薦策略，提升交叉銷售成功率
- **業務賦能**：為業務團隊提供可操作的客戶洞察與推薦清單
- **數據驅動**：將經驗決策轉變為數據驅動的科學決策

### 為何現在重要
保險業競爭激烈，客戶獲取成本持續攀升。透過 AI 技術深化現有客戶價值、提升交叉銷售效率，是低成本高效益的成長策略。

## User Stories

### 主要用戶角色

#### 角色 1: 保險業務經理
**背景**：負責管理業務團隊，制定銷售策略，追蹤業績目標
**技術能力**：中等，熟悉資料報表與視覺化工具

**User Story 1.1: 客戶價值分群報告**
```
作為保險業務經理
我想要查看客戶價值分群的視覺化儀表板
以便將高價值客戶分配給資深業務員，優化資源配置

驗收標準：
- 能看到高/中/低價值客戶的數量與占比
- 顯示各群組的平均保險持有數量與類型
- 提供可匯出的客戶清單（含分群標籤）
- 支援按區域、年齡等維度篩選
```

**User Story 1.2: 交叉銷售機會識別**
```
作為保險業務經理
我想要系統自動識別最有潛力的交叉銷售機會
以便為團隊制定每週行銷目標

驗收標準：
- 顯示 Top 100 最有可能購買的客戶清單
- 每個客戶顯示推薦產品與購買機率
- 能依產品類型篩選推薦清單
- 提供預期轉換率估算
```

#### 角色 2: 保險業務員
**背景**：第一線銷售人員，直接與客戶互動
**技術能力**：基礎，主要使用行動裝置與簡單報表

**User Story 2.1: 個別客戶推薦**
```
作為保險業務員
我想要輸入客戶 ID 立即取得該客戶的推薦報告
以便在拜訪前準備個人化的銷售話術

驗收標準：
- 3 秒內顯示客戶推薦報告
- 報告包含：客戶價值分群、現有保險組合、推薦產品 Top 3
- 每個推薦產品顯示購買機率與推薦理由
- 支援手機瀏覽器存取
```

**User Story 2.2: 批量客戶預測**
```
作為保險業務員
我想要上傳我負責的客戶清單，批量取得推薦結果
以便規劃本週的拜訪優先順序

驗收標準：
- 支援 CSV 檔案上傳（最多 500 筆）
- 10 分鐘內完成批量預測
- 匯出結果包含所有客戶的推薦產品與機率
- 結果按購買機率由高到低排序
```

#### 角色 3: 數據分析師
**背景**：負責模型監控、效能分析與業務洞察
**技術能力**：高，熟悉 Python、SQL、統計分析

**User Story 3.1: 模型效能監控**
```
作為數據分析師
我想要監控模型的預測準確率與業務成效
以便評估模型是否需要重新訓練

驗收標準：
- 儀表板顯示模型準確率、精確率、召回率趨勢
- 顯示實際交叉銷售轉換率 vs 預測轉換率
- 能依時間區間、產品類型分析效能
- 提供每日預測量與成功案例統計
```

**User Story 3.2: 模型重新訓練**
```
作為數據分析師
我想要使用最新的交易資料重新訓練模型
以便持續優化預測準確度

驗收標準：
- 支援上傳新訓練資料（與 COIL 2000 格式相容）
- 顯示訓練進度與預估完成時間
- 訓練完成後自動產生模型效能報告
- 支援 A/B 測試新舊模型
```

### 使用者旅程

#### 旅程 1: 每週銷售計畫制定（業務經理）
1. 週一早上登入系統
2. 查看客戶價值分群儀表板，了解客戶分布
3. 檢視系統推薦的 Top 100 交叉銷售機會
4. 依產品類型篩選（例如：旅行保險）
5. 匯出高價值客戶清單
6. 分配客戶給相應業務員
7. 設定本週交叉銷售目標

#### 旅程 2: 客戶拜訪準備（業務員）
1. 收到本週客戶清單
2. 選擇第一個客戶，輸入客戶 ID
3. 查看系統產生的個人化推薦報告
4. 了解客戶現有保險組合與推薦產品
5. 準備針對性的銷售話術
6. 拜訪客戶並提出推薦
7. 拜訪後回報成交結果（供模型學習）

#### 旅程 3: 模型效能評估（數據分析師）
1. 每月 1 號檢視模型效能報告
2. 分析準確率是否下降
3. 檢視近期失敗案例的特徵
4. 收集最新 3 個月的交易資料
5. 啟動模型重新訓練流程
6. 驗證新模型效能
7. 部署新模型到生產環境

## Requirements

### Functional Requirements

#### FR-1: 交叉銷售預測引擎
- **FR-1.1** 系統應使用 DQN 模型根據客戶現有保險組合預測下一個最可能購買的產品
- **FR-1.2** 系統應為每個預測產品計算購買機率（0-100%）
- **FR-1.3** 系統應支援單筆客戶即時預測（回應時間 < 3 秒）
- **FR-1.4** 系統應支援批量客戶預測（最多 500 筆，完成時間 < 10 分鐘）
- **FR-1.5** 系統應為每個客戶提供 Top 3 推薦產品清單
- **FR-1.6** 系統應提供推薦理由說明（基於客戶特徵與模型權重）

#### FR-2: 客戶價值分群引擎
- **FR-2.1** 系統應使用 XGBoost 模型將客戶分類為高/中/低價值三個群組
- **FR-2.2** 系統應基於社會人口統計特徵與保險持有情況進行分群
- **FR-2.3** 系統應為每個客戶提供價值評分（0-100）
- **FR-2.4** 系統應支援批量客戶分群處理
- **FR-2.5** 系統應提供各群組的特徵統計分析

#### FR-3: 視覺化儀表板
- **FR-3.1** 系統應提供客戶價值分群的視覺化儀表板（圓餅圖、柱狀圖）
- **FR-3.2** 系統應顯示交叉銷售機會清單（可排序、篩選）
- **FR-3.3** 系統應提供個別客戶的詳細推薦報告頁面
- **FR-3.4** 系統應支援按時間、區域、年齡、產品類型等維度篩選
- **FR-3.5** 系統應提供模型效能監控儀表板（準確率、轉換率趨勢）
- **FR-3.6** 儀表板應支援手機、平板、桌機瀏覽器（RWD）

#### FR-4: 資料管理
- **FR-4.1** 系統應支援上傳 COIL 2000 格式的訓練資料
- **FR-4.2** 系統應支援匯出客戶清單（CSV、Excel 格式）
- **FR-4.3** 系統應支援匯出預測報告（PDF、CSV 格式）
- **FR-4.4** 系統應記錄歷史預測結果供追蹤分析
- **FR-4.5** 系統應支援業務員回報成交結果（feedback loop）

#### FR-5: 模型訓練與管理
- **FR-5.1** 系統應提供 DQN 模型訓練功能（初始訓練 + 重新訓練）
- **FR-5.2** 系統應提供 XGBoost 模型訓練功能
- **FR-5.3** 系統應顯示訓練���度與預估完成時間
- **FR-5.4** 系統應自動產生模型效能報告（準確率、混淆矩陣、特徵重要性）
- **FR-5.5** 系統應支援模型版本管理與 A/B 測試
- **FR-5.6** 系統應支援模型參數調整（hyperparameter tuning）

#### FR-6: API 介面
- **FR-6.1** 系統應提供 RESTful API 供外部系統整合
- **FR-6.2** API 應包含：單筆預測、批量預測、客戶分群端點
- **FR-6.3** API 應提供完整的文件與範例程式碼
- **FR-6.4** API 應支援 API Key 認證機制

### Non-Functional Requirements

#### NFR-1: 效能要求
- **NFR-1.1** 單筆客戶預測回應時間 < 3 秒（95th percentile）
- **NFR-1.2** 批量預測（500 筆）完成時間 < 10 分鐘
- **NFR-1.3** 儀表板頁面載入時間 < 2 秒
- **NFR-1.4** 系統應支援同時 50 個使用者線上操作
- **NFR-1.5** 模型訓練時間：DQN < 2 小時，XGBoost < 30 分鐘（基於 COIL 2000 資料集規模）

#### NFR-2: 準確率要求
- **NFR-2.1** 交叉銷售預測準確率 ≥ 75%（基於測試集驗證）
- **NFR-2.2** 客戶價值分群準確率 ≥ 85%（基於測試集驗證）
- **NFR-2.3** Top 3 推薦產品至少一個命中的機率 ≥ 85%
- **NFR-2.4** 業務實際轉換率提升 ≥ 20%（相較於隨機推薦）

#### NFR-3: 可用性要求
- **NFR-3.1** 系統可用性 ≥ 99%（允許計畫性維護停機）
- **NFR-3.2** 系統應提供健康檢查端點（health check）
- **NFR-3.3** 關鍵錯誤應於 10 分鐘內發送告警通知
- **NFR-3.4** 系統應每日自動備份資料與模型

#### NFR-4: 安全性要求
- **NFR-4.1** 客戶資料應加密儲存（AES-256）
- **NFR-4.2** 資料傳輸應使用 HTTPS/TLS 1.3
- **NFR-4.3** 系統應實作角色基礎存取控制（RBAC）
- **NFR-4.4** API 應實作速率限制（rate limiting）防止濫用
- **NFR-4.5** 敏感操作應記錄稽核日誌（audit log）
- **NFR-4.6** 系統應符合 GDPR 個人資料保護規範

#### NFR-5: 可擴展性要求
- **NFR-5.1** 系統架構應支援水平擴展（horizontal scaling）
- **NFR-5.2** 資料庫應支援 10 萬筆以上客戶資料
- **NFR-5.3** 模型推論服務應可獨立擴展
- **NFR-5.4** 系統應支援新增更多保險產品類型（無需重構）

#### NFR-6: 可維護性要求
- **NFR-6.1** 程式碼應遵循 PEP 8 規範（Python）
- **NFR-6.2** 核心功能應有單元測試覆蓋率 ≥ 80%
- **NFR-6.3** 系統應提供完整的技術文件與部署指南
- **NFR-6.4** 模型訓練過程應可重現（reproducible）
- **NFR-6.5** 系統應使用容器化部署（Docker）

#### NFR-7: 可用性（Usability）要求
- **NFR-7.1** 新使用者應於 30 分鐘內完成第一次預測操作
- **NFR-7.2** 介面應支援繁體中文與英文雙語
- **NFR-7.3** 系統應提供使用者教學影片與操作手冊
- **NFR-7.4** 錯誤訊息應清晰指出問題與建議解決方案

## Success Criteria

### 技術指標
1. **模型效能**
   - 交叉銷售預測準確率達 75%+（測試集）
   - 客戶分群準確率達 85%+（測試集）
   - Top 3 推薦命中率達 85%+
   - 模型訓練可重現性 100%

2. **系統效能**
   - 單筆預測回應時間 < 3 秒（95th percentile）
   - 系統可用性達 99%+
   - 同時支援 50+ 並發使用者
   - API 回應時間中位數 < 500ms

3. **資料品質**
   - 預測結果記錄完整率 100%
   - 資料備份成功率 100%
   - 無客戶資料外洩事件

### 業務指標
1. **使用率指標**（上線後 3 個月）
   - 業務經理週活躍使用率 ≥ 90%
   - 業務員週活躍使用率 ≥ 70%
   - 平均每週預測查詢量 ≥ 1000 次
   - 推薦報告匯出量 ≥ 200 次/週

2. **業務成效指標**（上線後 6 個月）
   - 交叉銷售轉換率提升 20-30%（相較於傳統方法）
   - 高價值客戶成交率提升 ≥ 25%
   - 業務員平均拜訪效率提升 ≥ 15%（成交/拜訪比）
   - 每客戶平均保險持有數增加 ≥ 0.3

3. **ROI 指標**（上線後 12 個月）
   - 新增保險收入增加 ≥ 15%（歸因於系統推薦）
   - 行銷成本節省 ≥ 10%（精準定向）
   - 系統投資回收期 < 18 個月

### 用戶滿意度指標
- 業務團隊系統滿意度 ≥ 4.0/5.0
- 推薦產品相關性評分 ≥ 4.2/5.0
- 介面易用性評分 ≥ 4.0/5.0
- 系統推薦的信任度 ≥ 3.8/5.0

## Constraints & Assumptions

### 技術限制
1. **資料集限制**
   - 初始訓練僅使用 UCI COIL 2000 資料集（5822 筆訓練 + 4000 筆測試）
   - 資料集時間較舊（2000 年），可能與現代客戶行為有差異
   - 資料集僅包含特定國家/地區（荷蘭）的保險資料

2. **模型限制**
   - DQN 模型需要大量運算資源進行訓練
   - 模型預測基於歷史資料，無法考慮突發事件（如疫情）
   - 冷啟動問題：新客戶缺乏歷史資料時預測準確度降低

3. **基礎設施限制**
   - 開發階段使用單機環境，非分散式架構
   - GPU 資源有限，影響 DQN 訓練速度
   - 暫不支援即時模型更新（需離線重新訓練）

### 業務假設
1. **使用者假設**
   - 業務團隊願意採用 AI 推薦系統
   - 使用者具備基本的電腦/手機操作能力
   - 業務員會回報成交結果供模型改進

2. **資料假設**
   - COIL 2000 資料集的特徵工程適用於目標市場
   - 客戶行為模式在合理時間內保持穩定
   - 訓練資料無重大偏差或資料品質問題

3. **市場假設**
   - 客戶願意接受業務員基於 AI 的產品推薦
   - 交叉銷售仍是有效的保險業務成長策略
   - 競爭對手尚未廣泛採用類似 AI 系統

### 時間限制
- **Phase 1（MVP）**：3 個月完成核心預測功能
- **Phase 2（Dashboard）**：2 個月完成視覺化介面
- **Phase 3（優化）**：2 個月模型優化與 API 整合
- **總計**：7 個月內完成完整系統上線

### 資源限制
- **開發團隊**：1 位 ML 工程師 + 1 位後端工程師 + 1 位前端工程師
- **預算**：有限的雲端運算預算（優先考慮成本效益方案）
- **測試資源**：需協調 10-20 位業務人員參與 UAT 測試

### 合規限制
- 必須符合 GDPR 個人資料保護法規
- 客戶資料不得跨境傳輸（除非符合法規要求）
- AI 推薦決策需具備可解釋性（避免黑盒問題）
- 需取得客戶同意使用資料進行 AI 分析

## Out of Scope

本版本明確**不包含**以下功能：

### 不包含的功能
1. **即時模型更新**
   - 不支援線上學習（online learning）
   - 模型更新需離線重新訓練後部署

2. **多語言支援（除繁中/英文外）**
   - 第一版僅支援繁體中文與英文
   - 其他語言（如日文、韓文）留待未來版本

3. **行動 App**
   - 僅提供響應式網頁（RWD），不開發原生 iOS/Android App
   - 業務員透過手機瀏覽器存取

4. **自動化行銷執行**
   - 系統僅提供推薦清單，不自動發送 EDM 或簡訊
   - 行銷執行仍由業務團隊手動進行

5. **客戶關係管理（CRM）整合**
   - 不與現有 CRM 系統深度整合
   - 資料需手動匯出/匯入

6. **理賠預測**
   - 僅專注於交叉銷售與客戶分群
   - 不預測理賠金額或理賠機率

7. **動態定價**
   - 不提供保險產品動態定價建議
   - 價格策略由產品團隊決定

8. **語音/聊天機器人介面**
   - 不提供語音助手或 chatbot 介面
   - 僅提供圖形化網頁介面

9. **多保險公司資料整合**
   - 僅支援單一保險公司內部資料
   - 不整合跨公司或第三方資料源

10. **即時客戶互動追蹤**
    - 不追蹤客戶的網站瀏覽行為或即時互動
    - 僅基於靜態客戶資料進行預測

### 未來可能擴展的範圍
- 深度學習模型的持續優化與實驗（如 Transformer、GNN）
- 與第三方資料源整合（如社群媒體、信用評分）
- 多通路行銷自動化平台整合
- 進階的客戶生命週期價值（CLV）預測

## Dependencies

### 外部依賴

#### 資料依賴
- **UCI COIL 2000 資料集**
  - 來源：UCI Machine Learning Repository
  - 格式：純文字檔（ticdata2000.txt, ticeval2000.txt, tictgts2000.txt）
  - 風險：資料集已公開，無可用性風險
  - 負責人：資料科學團隊

#### 技術棧依賴
- **Python 3.8+**
  - 核心開發語言
  - 風險：版本相容性問題（低風險）

- **深度學習框架**
  - TensorFlow 2.x 或 PyTorch 1.x（用於 DQN）
  - 風險：框架更新可能導致 API 變更（中風險）
  - 緩解：鎖定特定版本

- **機器學習框架**
  - XGBoost 1.5+（用於客戶分群）
  - scikit-learn 1.0+（資料前處理）
  - 風險：低

- **Web 框架**
  - 後端：Flask/FastAPI（Python）
  - 前端：React.js + Chart.js/D3.js（視覺化）
  - 風險：低

- **資料庫**
  - PostgreSQL 13+（客戶資料與預測記錄）
  - Redis（快取與排程）
  - 風險：低

- **基礎設施**
  - Docker（容器化）
  - 雲端平台：AWS/GCP/Azure（待選）
  - 風險：雲端平台選擇影響後續架構（中風險）

#### 第三方服務依賴
- **無關鍵外部 API 依賴**（初版純內部系統）

### 內部依賴

#### 團隊依賴
- **業務團隊**
  - 需求：提供業務場景驗證與回饋
  - 時間點：需求定義階段、UAT 測試階段
  - 風險：業務團隊時間有限，可能延遲需求確認
  - 緩解：提前排程、明確時間承諾

- **IT 基礎設施團隊**
  - 需求：提供伺服器資源、網路配置、權限管理
  - 時間點：部署階段
  - 風險：資源申請流程冗長（高風險）
  - 緩解：提前 1 個月申請資源

- **資訊安全團隊**
  - 需求：安全審查、滲透測試、合規確認
  - 時間點：上線前 2 週
  - 風險：安全審查發現重大問題需返工（中風險）
  - 緩解：開發階段遵循安全最佳實踐

- **法務/合規團隊**
  - 需求：GDPR 合規審查、資料使用授權確認
  - 時間點：上線前 1 個月
  - 風險：合規問題可能阻擋上線（高風險）
  - 緩解：開發初期即諮詢法務意見

#### 資料依賴
- **客戶主資料（MDM）**
  - 需求：同步最新的客戶基本資料
  - 頻率：每日批次更新
  - 風險：資料品質問題影響預測準確度（高風險）
  - 緩解：實作資料驗證與清洗機制

- **保險交易資料**
  - 需求：歷史保險購買記錄
  - 風險：資料格式不一致、缺失值過多（中風險）
  - 緩解：資料探索階段提前發現問題

#### 系統依賴
- **身份認證系統（SSO）**
  - 需求：整合公司既有的單一登入系統
  - 時間點：開發後期
  - 風險：SSO 整合技術複雜（中風險）
  - 緩解：初版可使用簡單的帳密認證，後續整合 SSO

### 關鍵里程碑依賴關係

```
資料準備 → 模型開發 → 模型訓練 → API 開發 → 前端開發 → 整合測試 → 安全審查 → UAT → 上線
    ↓          ↓          ↓          ↓          ↓          ↓          ↓        ↓
 (Week 1-2) (Week 3-6) (Week 7-8) (Week 9-10)(Week 11-13)(Week 14)  (Week 15-16)(Week 17-18)
```

**關鍵依賴**：
- 模型開發必須等待資料準備完成
- API 開發依賴模型訓練完成
- 前端開發可與 API 開發部分並行（使用 mock data）
- UAT 必須等待安全審查通過
- 上線依賴所有前置階段完成

### 風險緩解策略
1. **提前識別阻塞依賴**：每週 sync meeting 追蹤依賴項目進度
2. **建立 mock/stub**：前端開發使用 mock API 避免阻塞
3. **並行開發**：獨立模組盡可能並行開發
4. **備援方案**：關鍵依賴準備 Plan B（如雲端平台備選方案）

## Technical Architecture

### 系統架構圖（高層級）

```
┌─────────────────────────────────────────────────────────────┐
│                         前端層                                │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ 業務儀表板    │  │ 客戶推薦頁面  │  │ 模型管理介面  │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
│                    (React.js + Chart.js)                     │
└─────────────────────────────────────────────────────────────┘
                              ↓ HTTPS
┌─────────────────────────────────────────────────────────────┐
│                      API Gateway 層                           │
│              (FastAPI + JWT Authentication)                   │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                       應用服務層                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ 推薦服務      │  │ 分群服務      │  │ 訓練服務      │      │
│  │ (DQN 推論)   │  │ (XGBoost)    │  │ (Model Train) │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                       模型層                                  │
│  ┌──────────────┐           ┌──────────────┐               │
│  │  DQN Model   │           │ XGBoost Model│               │
│  │ (TensorFlow) │           │  (XGBoost)   │               │
│  └──────────────┘           └──────────────┘               │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                      資料層                                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ PostgreSQL   │  │    Redis     │  │  File Storage│      │
│  │ (客戶/預測)   │  │   (快取)      │  │  (模型檔案)   │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└────���────────────────────────────────────────────────────────┘
```

### 核心技術選型

#### DQN（Deep Q-Network）實作
- **框架**：TensorFlow 2.x / PyTorch
- **網路結構**：
  - 輸入層：客戶特徵向量（86 維，基於 COIL 2000）
  - 隱藏層：3 層全連接層（256-128-64 神經元）
  - 輸出層：保險產品動作空間（約 10-15 個產品）
- **訓練策略**：
  - Experience Replay（經驗回放）
  - Target Network（目標網路）
  - ε-greedy 探索策略
- **獎勵函數**：基於實際購買結果（購買=+1，未購買=-0.1）

#### XGBoost 客戶分群
- **框架**：XGBoost 1.5+
- **特徵工程**：
  - 社會人口統計特徵（年齡、收入、教育等）
  - 保險持有特徵（產品數量、類型組合）
  - 衍生特徵（產品多樣性、總保費估算）
- **分類策略**：
  - 多分類問題（3 類：高/中/低價值）
  - 使用 softmax 輸出機率分布
- **超參數調整**：GridSearchCV / Optuna

### 資料流程

#### 訓練階段
```
COIL 2000 原始資料 → 資料清洗 → 特徵工程 → 訓練/測試分割 →
DQN 訓練（交叉銷售）+ XGBoost 訓練（客戶分群）→ 模型評估 →
模型儲存（.h5 / .pkl）
```

#### 推論階段
```
客戶輸入 → 特徵提取 → 載入模型 →
DQN 推論（Top 3 產品 + 機率）+ XGBoost 推論（價值分群 + 評分）→
結果整合 → 回傳 JSON → 前端展示
```

### 部署架構
- **容器化**：Docker + Docker Compose
- **模型服務**：獨立 microservice（可水平擴展）
- **負載平衡**：Nginx / AWS ALB
- **監控**：Prometheus + Grafana（效能監控）、MLflow（模型追蹤）

## Implementation Phases

### Phase 1: MVP - 核心預測功能（Week 1-12，3 個月）

#### Week 1-2: 資料準備與探索
- **任務**：
  - 載入 COIL 2000 資料集（ticdata2000.txt, ticeval2000.txt, tictgts2000.txt）
  - 資料探索性分析（EDA）：缺失值、分布、相關性
  - 資料清洗：處理缺失值、異常值、資料標準化
  - 特徵工程：產生衍生特徵、編碼類別變數
- **交付物**：
  - 清洗後的訓練/測試資料集（CSV 格式）
  - EDA 報告（Jupyter Notebook）
  - 特徵字典文件

#### Week 3-6: DQN 模型開發
- **任務**：
  - 設計 DQN 網路架構
  - 實作 Experience Replay 機制
  - 實作 Target Network 更新邏輯
  - 定義獎勵函數與狀態/動作空間
  - 模型訓練與超參數調整
  - 模型評估（準確率、Top-K 命中率）
- **交付物**：
  - 訓練好的 DQN 模型檔案（.h5）
  - 訓練過程日誌與視覺化
  - 模型效能報告（準確率、混淆矩陣）

#### Week 7-8: XGBoost 模型開發
- **任務**：
  - 設計客戶分群標籤（基於保險持有價值）
  - XGBoost 模型訓練
  - 超參數調整（GridSearch）
  - 特徵重要性分析
  - 模型評估（準確率、精確率、召回率）
- **交付物**：
  - 訓練好的 XGBoost 模型檔案（.pkl）
  - 特徵重要性報告
  - 模型效能報告

#### Week 9-10: API 開發
- **任務**：
  - 設計 RESTful API 規格（OpenAPI 文件）
  - 實作模型載入與推論邏輯
  - 實作 API 端點：
    - POST /api/predict/single（單筆預測）
    - POST /api/predict/batch（批量預測）
    - POST /api/segment/customer（客戶分群）
  - API 單元測試
  - API 效能測試（負載測試）
- **交付物**：
  - FastAPI 應用程式碼
  - API 文件（Swagger UI）
  - 單元測試報告（覆蓋率 ≥ 80%）

#### Week 11-12: 整合測試與優化
- **任務**：
  - 端到端整合測試
  - 效能優化（推論速度、記憶體使用）
  - 錯誤處理與日誌記錄
  - Docker 容器化
  - 基本部署腳本
- **交付物**：
  - Docker Compose 配置
  - 部署指南文件
  - 整合測試報告

**Phase 1 成功標準**：
- ✅ DQN 模型準確率 ≥ 75%
- ✅ XGBoost 模型準確率 ≥ 85%
- ✅ API 回應時間 < 3 秒
- ✅ 可透過 API 成功取得預測結果

---

### Phase 2: 視覺化儀表板（Week 13-20，2 個月）

#### Week 13-14: 前端架構與基礎元件
- **任務**：
  - 設計 UI/UX 原型（Figma）
  - 建立 React 專案架構
  - 實作基礎元件（表格、卡片、導航列）
  - 實作 API 串接層（axios）
  - 身份認證（簡易版 JWT）
- **交付物**：
  - UI/UX 設計稿
  - React 專案骨架
  - 可登入的前端頁面

#### Week 15-17: 核心儀表板開發
- **任務**：
  - **客戶價值分群儀表板**：
    - 圓餅圖（高/中/低價值客戶占比）
    - 群組統計表格
    - 篩選器（區域、年齡）
  - **交叉銷售機會清單**：
    - Top 100 客戶推薦清單
    - 可排序、篩選、搜尋
    - 匯出 CSV 功能
  - **個別客戶推薦頁面**：
    - 輸入客戶 ID 查詢
    - 顯示客戶資訊、現有保險、推薦產品
    - PDF 報告匯出
- **交付物**：
  - 完整的儀表板頁面
  - 響應式設計（手機/平板/桌機）

#### Week 18-19: 模型管理介面
- **任務**：
  - 模型效能監控儀表板：
    - 準確率、精確率、召回率趨勢圖
    - 預測量統計
  - 模型重新訓練介面：
    - 上傳訓練資料
    - 啟動訓練任務
    - 訓練進度顯示
  - 模型版本管理
- **交付物**：
  - 模型管理頁面
  - 訓練任務排程機制

#### Week 20: UI/UX 優化與使用者測試
- **任務**：
  - 內部使用者測試（5-10 位業務人員）
  - 收集回饋並優化 UI
  - 效能優化（頁面載入速度）
  - 多語言支援（繁中/英文）
- **交付物**：
  - 使用者測試報告
  - 優化後的前端應用

**Phase 2 成功標準**：
- ✅ 頁面載入時間 < 2 秒
- ✅ 手機瀏覽器可正常操作
- ✅ 使用者測試滿意度 ≥ 4.0/5.0
- ✅ 所有核心功能可透過 UI 操作

---

### Phase 3: 優化與上線準備（Week 21-28，2 個月）

#### Week 21-22: 模型優化與實驗
- **任務**：
  - DQN 超參數精調（learning rate, batch size, epsilon decay）
  - XGBoost 特徵選擇優化
  - 嘗試進階技術（如 Dueling DQN、Double DQN）
  - A/B 測試框架建立
- **交付物**：
  - 優化後的模型版本
  - 實驗報告（對比基準版本）

#### Week 23-24: 系統整合與 API 擴展
- **任務**：
  - API 完整文件撰寫（含範例程式碼）
  - API 認證機制（API Key）
  - 速率限制（rate limiting）
  - Webhook 支援（預測完成通知）
  - 批量預測最佳化（平行處理）
- **交付物**：
  - 完整 API 文件
  - API 範例程式碼（Python、JavaScript）

#### Week 25: 安全性強化
- **任務**：
  - 資料加密（AES-256）
  - HTTPS/TLS 配置
  - SQL Injection 防護
  - XSS/CSRF 防護
  - 滲透測試（內部或委外）
  - 安全稽核日誌
- **交付物**：
  - 安全性檢查清單
  - 滲透測試報告

#### Week 26: 合規性審查
- **任務**：
  - GDPR 合規檢查
  - 資料使用授權確認
  - 隱私政策撰寫
  - 法務團隊審查
  - 修正合規問題
- **交付物**：
  - 合規性報告
  - 隱私政策文件

#### Week 27: UAT（使用者驗收測試）
- **任務**：
  - 招募 15-20 位業務人員參與 UAT
  - 準備測試案例與測試資料
  - 執行 UAT（2 週）
  - 收集回饋與 bug
  - 修正問題
- **交付物**：
  - UAT 測試報告
  - Bug 修正清單

#### Week 28: 上線部署
- **任務**：
  - 生產環境部署（雲端平台）
  - 資料庫遷移與備份
  - 監控與告警配置（Prometheus + Grafana）
  - 健康檢查與自動恢復
  - 上線檢查清單驗證
  - 正式上線
  - 使用者培訓（操作手冊 + 教學影片）
- **交付物**：
  - 生產環境運行中的系統
  - 操作手冊與培訓教材
  - 上線報告

**Phase 3 成功標準**：
- ✅ 通過安全性審���
- ✅ 通過合規性審查
- ✅ UAT 測試通過率 ≥ 95%
- ✅ 系統成功上線且穩定運行

---

### 上線後（Month 7-12）：監控與持續改進

#### Month 7-9: 效能監控與小修正
- 每週檢視系統效能指標
- 監控模型準確率是否下降
- 收集業務團隊使用回饋
- 快速修正小 bug 與 UI 優化

#### Month 10-12: 業務成效評估與模型迭代
- 評估業務 KPI（轉換率提升、收入增長）
- 收集足夠的實際使用資料
- 重新訓練模型（基於真實回饋）
- 規劃下一階段功能（如 CRM 整合、多產品推薦）

---

## Training & Documentation

### 使用者培訓計畫

#### 目標受眾分群培訓
1. **業務經理培訓（2 小時）**
   - 系統價值與業務目標
   - 儀表板操作示範
   - 如何解讀客戶分群報告
   - 如何制定週銷售計畫
   - Q&A

2. **業務員培訓（1.5 小時）**
   - 客戶推薦報告解讀
   - 如何查詢個別客戶推薦
   - 如何匯出推薦清單
   - 如何回報成交結果
   - 手機操作示範
   - Q&A

3. **數據分析師培訓（3 小時）**
   - 系統技術架構
   - 模型原理與限制
   - 模型效能監控
   - 如何重新訓練模型
   - API 使用與整合
   - Q&A

#### 培訓教材
- **操作手冊**（PDF，50-80 頁）
  - 系統簡介
  - 功能詳解（含截圖）
  - 常見問題 FAQ
  - 故障排除指南

- **教學影片**（10-15 分鐘 x 5 支）
  - 影片 1：系統介紹與登入
  - 影片 2：查詢客戶推薦報告
  - 影片 3：使用儀表板制定銷售計畫
  - 影片 4：匯出與列印報告
  - 影片 5：常見問題解答

- **快速參考卡**（PDF，2 頁）
  - 常用功能速查表
  - 快捷鍵
  - 聯絡支援方式

### 技術文件

#### 開發者文件
1. **系統架構文件**（50 頁）
   - 整體架構圖
   - 技術棧選型說明
   - 資料流程圖
   - API 規格
   - 資料庫 Schema

2. **模型文件**（30 頁）
   - DQN 模型原理與架構
   - XGBoost 模型設計
   - 特徵工程說明
   - 訓練流程與參數
   - 模型評估方法

3. **API 文件**（OpenAPI 3.0）
   - 所有端點規格
   - 請求/回應範例
   - 錯誤碼說明
   - 認證機制
   - 範例程式碼（Python、JavaScript、cURL）

4. **部署指南**（20 頁）
   - 環境需求
   - Docker 部署步驟
   - 雲端部署指南（AWS/GCP/Azure）
   - 資料庫設定
   - 監控配置
   - 備份與恢復

5. **維護手冊**（30 頁）
   - 日常維護檢查清單
   - 常見問題故障排除
   - 日誌分析指南
   - 效能調優建議
   - 安全性最佳實踐

#### 程式碼文件
- **README.md**：專案簡介、快速開始
- **CONTRIBUTING.md**：開發規範、PR 流程
- **CHANGELOG.md**：版本更新記錄
- **程式碼註解**：關鍵函數與類別加上 docstring

### 支援機制

#### 技術支援
- **線上支援**：Slack 頻道或內部即時通訊
- **Email 支援**：support@company.com
- **回應時間 SLA**：
  - 緊急問題（系統當機）：30 分鐘內回應
  - 一般問題：4 小時內回應
  - 功能諮詢：1 工作日內回應

#### 知識庫
- 建立內部 Wiki（Confluence / Notion）
- 收錄常見問題與解決方案
- 定期更新最佳實踐案例

---

## Risk Assessment & Mitigation

### 高風險項目

#### 風險 1: 模型準確率未達標（準確率 < 75%）
- **機率**：中（30%）
- **影響**：高（業務團隊不信任推薦結果，系統使用率低）
- **緩解策略**：
  1. 資料探索階段深入分析資料品質
  2. 實作多種模型進行對比（如 Random Forest、LightGBM）
  3. 預留 2 週 buffer 進行模型調優
  4. 若準確率仍不足，降低初期目標至 70%，持續迭代改進
- **應變計畫**：採用 XGBoost 替代 DQN 進行交叉銷售預測（放棄強化學習，改用監督式學習）

#### 風險 2: 資料品質問題（缺失值過多、資料偏差）
- **機率**：中高（40%）
- **影響**：高（影響模型訓練與準確率）
- **緩解策略**：
  1. Week 1-2 進行詳細 EDA
  2. 實作資料清洗與插補策略
  3. 若缺失值過多（>30%），考慮捨棄該特徵
  4. 使用 SMOTE 等技術處理類別不平衡
- **應變計畫**：若 COIL 2000 資料不適用，尋找其他公開保險資料集或使用合成資料

#### 風險 3: 基礎設施資源不足（GPU、伺服器）
- **機率**：中（30%）
- **影響**：中（延長訓練時間，影響開發進度）
- **緩解策略**：
  1. 提前 1 個月申請雲端運算資源
  2. 使用 Google Colab / Kaggle Kernel 作為備援訓練環境
  3. 優化模型大小以適應有限資源
- **應變計畫**：使用較小的模型架構或減少訓練 epoch 數

#### 風險 4: 安全性或合規性審查失敗
- **機率**：中（25%）
- **影響**：高（阻擋上線，時程延遲）
- **緩解策略**：
  1. 開發初期即諮詢資安與法務團隊
  2. 遵循 OWASP Top 10 安全最佳實踐
  3. 提前 4 週進行內部安全審查
  4. 預留 2 週 buffer 處理審查發現的問題
- **應變計畫**：若無法通過審查，降級上線（如先內部測試，暫不對外）

### 中風險項目

#### 風險 5: 業務團隊採用率低
- **機率**：中（30%）
- **影響**：中（無法驗證業務成效）
- **緩解策略**：
  1. 需求階段深入訪談業務團隊
  2. UAT 階段充分收集回饋並快速優化
  3. 提供完善的培訓與支援
  4. 設計簡潔直覺的 UI/UX
  5. 高層支持與推動（KPI 綁定）
- **應變計畫**：設計激勵機制（如使用系統推薦的業務員獲得獎金加成）

#### 風險 6: API 效能不符預期（回應時間 > 3 秒）
- **機率**：低（20%）
- **影響**：中（影響使用者體驗）
- **緩解策略**：
  1. 實作模型推論快取（Redis）
  2. 批量預測使用非同步任務（Celery）
  3. 模型優化（如量化、剪枝）
  4. 負載測試與效能調優
- **應變計畫**：增加伺服器資源或使用模型蒸餾技術減少模型大小

#### 風險 7: 第三方依賴套件更新導致相容性問題
- **機率**：低（15%）
- **影響**：中（需花時間修正）
- **緩解策略**：
  1. 鎖定套件版本（requirements.txt）
  2. 使用虛擬環境隔離
  3. 定期更新依賴並測試
- **應變計畫**：回退至先前穩定版本

### 低風險項目

#### 風險 8: 雲端平台故障
- **機率**：低（5%）
- **影響**：高（系統無法使用）
- **緩解策略**：
  1. 選擇可靠的雲端供應商（AWS/GCP/Azure）
  2. 實作健康檢查與自動重啟
  3. 資料每日備份
- **應變計畫**：多區域部署（multi-region）或備援雲端平台

#### 風險 9: 關鍵開發人員離職
- **機率**：低（10%）
- **影響**：高（知識流失，進度延遲）
- **緩解策略**：
  1. 完善的技術文件
  2. 程式碼審查與知識分享
  3. 至少 2 人熟悉關鍵模組
- **應變計畫**：快速招募替代人員或外包支援

---

## Appendix

### A. 專有名詞解釋

- **DQN (Deep Q-Network)**：深度強化學習演算法,結合深度神經網路與 Q-learning,用於決策最佳化
- **XGBoost (eXtreme Gradient Boosting)**：梯度提升樹演算法,廣泛應用於分類與迴歸任務
- **COIL 2000**：荷蘭保險公司資料集,包含 5822 筆訓練資料與 4000 筆測試資料,用於預測客戶購買旅行保險的傾向
- **Experience Replay**：DQN 訓練技巧,儲存過去經驗並隨機抽樣訓練,打破資料相關性
- **Target Network**：DQN 訓練技巧,使用獨立的目標網路穩定訓練過程
- **ε-greedy**：探索與利用平衡策略,以機率 ε 隨機選擇動作,其餘時間選擇最佳動作
- **交叉銷售 (Cross-selling)**：向現有客戶推薦額外的產品或服務
- **客戶價值分群 (Customer Segmentation)**：根據客戶特徵將客戶分類為不同價值群組
- **RWD (Responsive Web Design)**：響應式網頁設計,自動適應不同裝置螢幕
- **GDPR (General Data Protection Regulation)**：歐盟一般資料保護規範

### B. 參考資料

1. **COIL 2000 資料集**
   - UCI Repository: https://archive.ics.uci.edu/ml/datasets/Insurance+Company+Benchmark+(COIL+2000)

2. **DQN 論文**
   - Mnih et al., "Human-level control through deep reinforcement learning", Nature 2015

3. **XGBoost 論文**
   - Chen & Guestrin, "XGBoost: A Scalable Tree Boosting System", KDD 2016

4. **保險業 AI 應用案例**
   - McKinsey: "Insurance 2030—The impact of AI on the future of insurance"
   - Accenture: "Technology Vision for Insurance 2021"

### C. COIL 2000 資料集說明

**資料規模**：
- 訓練集：5822 筆客戶記錄
- 測試集：4000 筆客戶記錄
- 特徵數：86 個（社會人口統計 + 產品擁有資訊）
- 目標變數：是否購買旅行保險（二元分類）

**主要特徵類別**：
1. 社會人口統計（43 個特徵）：
   - 客戶主型態（Customer main type）
   - 購買力階級（Purchasing power class）
   - 社會階級（Social class）
   - 家庭組成（Household composition）等

2. 產品擁有資訊（43 個特徵）：
   - 現有保險產品數量
   - 各類型保險的持有情況
   - 貢獻度（Contribution）指標

**資料特性**：
- 類別不平衡：僅約 6% 客戶購買旅行保險
- 資料來源：1999-2000 年荷蘭保險公司真實資料
- 已匿名化處理，符合隱私保護

### D. 成功案例借鑑

**案例 1: Ping An Insurance (中國平安保險)**
- 使用 AI 進行客戶畫像與產品推薦
- 交叉銷售轉換率提升 30%
- 客戶滿意度提升 15%

**案例 2: Allianz (安聯保險)**
- 使用機器學習優化客戶分群
- 行銷 ROI 提升 25%
- 客戶流失率降低 10%

**案例 3: Lemonade Insurance**
- AI 驅動的保險推薦引擎
- 90 秒完成保險購買流程
- 客戶獲取成本降低 40%

---

## Revision History

| 版本 | 日期 | 修改者 | 修改說明 |
|------|------|--------|----------|
| 1.0  | 2025-10-09 | Claude AI | 初版 PRD 建立 |

---

**文件狀態**: Backlog
**下一步行動**: 執行 `/pm:prd-parse insurance` 建立實作 Epic
