---
name: ollama-insurance-recommender
description: Ollama 驅動的智能保險推薦與銷售輔助系統，整合 Qwen2.5:7b 提供客戶分析和銷售話術
status: backlog
created: 2025-10-16T10:04:33Z
---

# PRD: Ollama Insurance Recommender

## Executive Summary

**Ollama 保險推薦系統**是一個整合 Ollama Qwen2.5:7b 大型語言模型的智能銷售輔助平台，用於增強現有的保險交叉銷售推薦系統。系統接收機器學習模型的預測結果，透過 LLM 深度分析客戶特徵，生成個人化的購買心理分析、痛點洞察和專業銷售話術，幫助業務人員提升成交率。

### 核心價值
- 🤖 **AI 驅動分析**：使用 Ollama Qwen2.5:7b 進行深度客戶洞察
- 💡 **智能話術生成**：自動生成個人化銷售腳本（開場白、說服點、結案技巧）
- 📊 **心理分析**：解析客戶購買動機和決策因素
- 🎯 **提升轉換率**：為業務人員提供科學化的銷售建議
- 🌐 **友善界面**：直觀的網頁操作介面

---

## Problem Statement

### 當前痛點

1. **缺乏購買原因說明**
   - 現有 ML 模型只提供「會買/不會買」的預測結果
   - 業務人員不了解「為什麼」客戶會購買
   - 無法針對性地調整銷售策略

2. **銷售話術通用化**
   - 業務人員使用統一的銷售話術
   - 未根據客戶特徵個人化溝通
   - 難以觸及客戶真正的痛點

3. **學習曲線高**
   - 新進業務人員需要長時間培訓
   - 缺乏實際案例和成功經驗參考
   - 難以快速提升銷售技巧

4. **資料分散**
   - 客戶資料、預測結果、銷售建議分散在不同系統
   - 業務流程不順暢
   - 效率低下

### 為什麼現在重要？

- 現有交叉銷售推薦系統已建立，具備堅實的 ML 基礎
- Ollama 本地運行，保證資料隱私和成本控制
- LLM 技術成熟，可提供高品質的自然語言分析
- 業務團隊急需提升成交率和客戶滿意度

---

## User Stories

### 主要用戶角色

#### 1. 保險業務員（Primary User）
**背景**：負責向客戶推銷保險產品，需要快速了解客戶需求並有效溝通

**目標**：
- 快速理解為什麼客戶適合某個保險產品
- 獲得個人化的銷售話術
- 提高成交率

#### 2. 業務主管（Secondary User）
**背景**：管理業務團隊，需要監控團隊表現並提供培訓

**目標**：
- 了解推薦系統效果
- 查看成功案例
- 培訓新進人員

#### 3. 系統管理員（Support User）
**背景**：負責系統維護和 Ollama 模型管理

**目標**：
- 確保系統穩定運行
- 優化模型表現
- 管理檔案結構

---

### 詳細用戶旅程

#### 旅程 1：業務員查詢客戶推薦

**場景**：業務員小王準備拜訪客戶張三，想了解該推薦哪些保險產品以及如何說服

**步驟**：
1. 小王打開網頁系統
2. 輸入客戶張三的基本資料（或從 CRM 匯入）
3. 點擊「獲取推薦」按鈕
4. 系統顯示：
   - 客戶基本資訊摘要
   - 推薦的 3 種保險產品
   - 每種產品的購買機率
5. 小王點擊「人壽保險」查看詳細分析
6. 系統展示：
   - ✅ 為什麼推薦這個產品（AI 分析）
   - 🎯 客戶痛點分析（家庭責任、風險意識等）
   - 💬 銷售話術（開場白、說服點、結案技巧）
   - 📊 成功率預測（85%）
   - 👥 相似客戶案例（已購買的類似客戶）
7. 小王複製話術，準備拜訪

**痛點解決**：
- ✅ 快速理解推薦理由
- ✅ 獲得個人化話術
- ✅ 增強信心

#### 旅程 2：批量處理客戶名單

**場景**：業務主管李經理需要為團隊準備本週拜訪名單的推薦分析

**步驟**：
1. 李經理上傳包含 100 位客戶的 CSV 檔案
2. 系統批量處理（可能需要 10-15 分鐘）
3. 生成批量報告，包含每位客戶的：
   - Top 3 推薦產品
   - 簡要推薦理由
   - 成功率
4. 李經理匯出報告分發給團隊

**痛點解決**：
- ✅ 高效處理大量客戶
- ✅ 統一的分析標準
- ✅ 便於團隊協作

#### 旅程 3：新進業務員學習

**場景**：新進業務員小陳需要快速學習如何推銷保險

**步驟**：
1. 小陳查看「成功案例」頁面
2. 篩選「人壽保險」相關案例
3. 學習不同客戶類型的銷售話術
4. 查看高成功率案例的共同特徵
5. 應用到自己的客戶推銷中

**痛點解決**：
- ✅ 快速學習
- ✅ 實戰案例參考
- ✅ 提升技能

---

## Requirements

### Functional Requirements

#### FR1: Ollama 整合
- **FR1.1** 系統能夠連接本地運行的 Ollama 服務
- **FR1.2** 自動載入 Qwen2.5:7b 模型
- **FR1.3** 處理 Ollama API 呼叫和回應
- **FR1.4** 實現錯誤處理和重試機制
- **FR1.5** 支援模型設定調整（temperature, top_p 等）

#### FR2: 客戶分析與推薦生成
- **FR2.1** 接收客戶基本資料（43 個特徵欄位）
- **FR2.2** 呼叫現有 ML 模型獲取預測結果
- **FR2.3** 整合客戶資料和預測結果，生成 Ollama 提示詞
- **FR2.4** 使用 Ollama 分析生成：
  - 購買原因分析（200-300 字）
  - 客戶痛點分析（3-5 個痛點）
  - 心理動機分析（風險意識、家庭責任等）
- **FR2.5** 計算並顯示成功率預測

#### FR3: 銷售話術生成
- **FR3.1** 根據客戶特徵生成個人化開場白
- **FR3.2** 生成 3-5 個核心說服點
- **FR3.3** 提供結案技巧建議
- **FR3.4** 生成應對常見異議的話術
- **FR3.5** 話術風格可調整（專業型、親和型、權威型）

#### FR4: 相似客戶案例
- **FR4.1** 從歷史資料中搜尋相似客戶
- **FR4.2** 相似度計算（基於客戶特徵）
- **FR4.3** 顯示成功購買的案例（脫敏處理）
- **FR4.4** 展示相似案例的銷售策略

#### FR5: 網頁使用者介面
- **FR5.1** 單一客戶分析頁面
  - 客戶資料輸入表單（支援手動輸入或 JSON 匯入）
  - 推薦產品列表展示（卡片式設計）
  - 詳細分析展開面板
- **FR5.2** 批量處理頁面
  - CSV 檔案上傳
  - 處理進度顯示
  - 批量報告下載
- **FR5.3** 成功案例庫頁面
  - 案例搜尋和篩選
  - 按產品類型分類
  - 案例詳情展示
- **FR5.4** 統計儀表板（可選）
  - 推薦成功率統計
  - 產品推薦分布
  - Ollama 使用統計

#### FR6: API 端點
- **FR6.1** `POST /api/ollama/analyze` - 單一客戶分析
- **FR6.2** `POST /api/ollama/batch` - 批量分析
- **FR6.3** `GET /api/ollama/status` - Ollama 服務狀態
- **FR6.4** `GET /api/ollama/cases` - 相似案例查詢
- **FR6.5** `GET /api/ollama/stats` - 統計資訊

#### FR7: 檔案管理與結構
- **FR7.1** 建立清晰的目錄結構：
  ```
  /models/              # ML 模型檔案
  /data/                # 訓練資料
  /api/                 # API 服務
    /routes/            # API 路由
    /controllers/       # 業務邏輯
    /services/          # 服務層
  /web/                 # 網頁界面
    /static/            # 靜態資源
    /templates/         # HTML 模板
  /ollama/              # Ollama 相關
    /prompts/           # 提示詞模板
    /config/            # 配置檔案
  /utils/               # 工具函數
  /logs/                # 日誌檔案
  /docs/                # 文檔
  ```
- **FR7.2** 程式碼模組化和註解完整
- **FR7.3** 配置檔案集中管理（config.yaml）

#### FR8: 資料持久化
- **FR8.1** 儲存客戶分析歷史（SQLite 或檔案）
- **FR8.2** 記錄 Ollama 回應快取（避免重複計算）
- **FR8.3** 儲存成功案例（用於學習）
- **FR8.4** 日誌記錄（請求、回應、錯誤）

---

### Non-Functional Requirements

#### NFR1: 效能
- **NFR1.1** 單一客戶分析回應時間 < 30 秒（Ollama 處理時間）
- **NFR1.2** 支援 1000+ 並發用戶
- **NFR1.3** 批量處理：100 客戶 < 15 分鐘
- **NFR1.4** 網頁載入時間 < 2 秒
- **NFR1.5** 實現快取機制減少重複計算

#### NFR2: 可用性
- **NFR2.1** 系統可用性 > 99%
- **NFR2.2** Ollama 服務異常時提供降級方案（顯示基本推薦）
- **NFR2.3** 自動重啟機制
- **NFR2.4** 健康檢查端點

#### NFR3: 安全性
- **NFR3.1** 客戶資料本地處理，不外傳
- **NFR3.2** API 存取控制（可選：基本認證）
- **NFR3.3** 輸入驗證和消毒（防止注入攻擊）
- **NFR3.4** 日誌不記錄敏感資料

#### NFR4: 可維護性
- **NFR4.1** 程式碼遵循 PEP 8 / Black 格式化
- **NFR4.2** 完整的 docstrings 和註解
- **NFR4.3** 單元測試覆蓋率 > 70%
- **NFR4.4** 詳細的 README 和使用文檔

#### NFR5: 可擴展性
- **NFR5.1** 支援未來新增其他 LLM 模型
- **NFR5.2** 提示詞模板化，易於調整
- **NFR5.3** 模組化設計，易於新增功能
- **NFR5.4** 支援水平擴展（多 Ollama 實例）

#### NFR6: 使用者體驗
- **NFR6.1** 響應式網頁設計（支援桌面和平板）
- **NFR6.2** 清晰的載入狀態提示
- **NFR6.3** 友善的錯誤訊息
- **NFR6.4** 操作指南和工具提示
- **NFR6.5** 支援繁體中文介面

---

## Success Criteria

### 關鍵成果指標（KPIs）

#### 1. 系統效能指標
- ✅ **回應時間**：95% 的請求在 30 秒內完成
- ✅ **系統可用性**：正常運行時間 > 99%
- ✅ **並發支援**：1000 用戶同時使用無明顯延遲
- ✅ **快取命中率**：> 40%（減少 Ollama 重複計算）

#### 2. 業務影響指標
- ✅ **成交率提升**：使用系統的業務員成交率提升 15-20%
- ✅ **銷售週期縮短**：平均銷售週期減少 10%
- ✅ **客戶滿意度**：客戶回饋滿意度 > 4.0/5.0
- ✅ **業務員採用率**：80% 業務員主動使用系統

#### 3. 功能完成度
- ✅ 所有核心功能（FR1-FR8）完整實現
- ✅ 生成的話術準確性 > 85%（人工評估）
- ✅ 相似案例推薦相關性 > 80%
- ✅ 網頁界面可用性測試通過率 > 90%

#### 4. 使用者滿意度
- ✅ 系統易用性評分 > 4.2/5.0
- ✅ 話術品質評分 > 4.0/5.0
- ✅ 分析深度評分 > 4.0/5.0
- ✅ 用戶留存率（持續使用） > 85%

### 驗收標準

#### Phase 1: 核心功能（MVP）
- [x] Ollama 整合完成並可正常呼叫
- [x] 單一客戶分析功能完整
- [x] 基本網頁界面可操作
- [x] 生成購買原因、痛點、話術三大核心內容
- [x] 檔案結構清晰且文檔完整

#### Phase 2: 進階功能
- [ ] 批量處理功能
- [ ] 相似案例推薦
- [ ] 統計儀表板
- [ ] 快取機制優化

#### Phase 3: 優化與擴展
- [ ] 效能優化（快取、並發處理）
- [ ] 提示詞優化（提升話術品質）
- [ ] 多語言支援（未來）
- [ ] 行動裝置適配

---

## Constraints & Assumptions

### 技術限制

#### 1. Ollama 相關
- **限制 1**：Ollama 必須在本地運行，需要足夠的硬體資源
  - CPU: 4 核心以上
  - RAM: 16GB 以上（推薦 32GB）
  - GPU: 可選，但能大幅提升速度
- **限制 2**：Qwen2.5:7b 模型回應時間 15-30 秒（無 GPU）
- **限制 3**：模型輸出品質受提示詞設計影響

#### 2. 整合限制
- **限制 4**：依賴現有 ML 模型正常運作
- **限制 5**：需要存取現有模型檔案（multi_insurance_model.pkl）
- **限制 6**：客戶資料格式必須符合現有系統標準（43 個特徵）

#### 3. 效能限制
- **限制 7**：批量處理速度受 Ollama 序列處理限制
- **限制 8**：並發請求受本地硬體資源限制
- **限制 9**：快取空間有限（需定期清理）

### 假設條件

#### 環境假設
- **假設 1**：Ollama 已安裝並可正常運行
- **假設 2**：Qwen2.5:7b 模型已下載
- **假設 3**：Python 3.8+ 環境已設定
- **假設 4**：現有交叉銷售推薦系統正常運行

#### 資料假設
- **假設 5**：客戶資料品質良好（完整、準確）
- **假設 6**：歷史資料可用於相似案例匹配
- **假設 7**：業務員會提供回饋以優化系統

#### 使用假設
- **假設 8**：業務員願意採用新系統
- **假設 9**：用戶具備基本電腦操作能力
- **假設 10**：網路環境穩定（本地網路）

### 時間限制

- **開發時間**：預計 4-6 週
  - Week 1-2: Ollama 整合 + 核心分析功能
  - Week 3-4: 網頁界面 + 話術生成
  - Week 5: 測試 + 優化
  - Week 6: 部署 + 文檔

### 資源限制

- **開發人員**：1-2 名全職開發者
- **測試人員**：業務團隊 5-10 人參與 UAT
- **硬體資源**：1 台本地伺服器（建議規格如上）

---

## Out of Scope

### 明確不包含的功能

#### 第一版不做
1. **雲端部署**
   - 不支援雲端 LLM API（如 OpenAI, Claude）
   - 僅支援本地 Ollama

2. **行動 App**
   - 不開發獨立的 iOS/Android App
   - 僅提供網頁版（響應式設計支援行動裝置瀏覽）

3. **CRM 深度整合**
   - 不直接整合企業 CRM 系統
   - 僅支援 CSV 匯入/匯出

4. **即時聊天**
   - 不提供即時客服聊天功能
   - 不支援與 Ollama 的對話式互動

5. **自動外撥/發送**
   - 不整合電話系統
   - 不自動發送簡訊或 Email

6. **複雜權限管理**
   - 不實現細粒度的角色權限控制
   - 僅支援基本的存取控制（可選）

#### 未來可能新增
1. **多模型支援**：支援其他開源 LLM（LLaMA, Mistral 等）
2. **語音輸入**：語音轉文字輸入客戶資料
3. **報表生成**：自動生成業務績效報告
4. **A/B 測試**：測試不同提示詞效果
5. **多語言**：支援英文、簡體中文等

#### 不在產品範圍
1. **訓練新 ML 模型**：僅使用現有模型
2. **資料收集**：不負責收集客戶資料
3. **業務流程改造**：不改變現有銷售流程
4. **硬體採購**：不負責伺服器硬體選購

---

## Dependencies

### 外部依賴

#### 技術依賴
1. **Ollama**
   - 版本：最新穩定版（0.1.x+）
   - 用途：運行 Qwen2.5:7b 模型
   - 風險：Ollama API 變更可能影響整合
   - 緩解：版本鎖定，定期測試新版本

2. **Qwen2.5:7b 模型**
   - 用途：自然語言分析和生成
   - 風險：模型品質影響輸出
   - 緩解：提示詞工程優化

3. **現有 ML 模型**
   - 檔案：multi_insurance_model.pkl
   - 用途：保險購買預測
   - 風險：模型更新可能需要適配
   - 緩解：版本化管理

#### Python 套件依賴
```python
flask>=3.0.0           # Web 框架
requests>=2.31.0       # HTTP 客戶端（呼叫 Ollama）
pandas>=2.1.4          # 資料處理
numpy>=1.26.2          # 數值計算
torch>=2.2.0           # 深度學習
xgboost>=2.0.3         # 機器學習
scikit-learn>=1.3.2    # 機器學習
jinja2>=3.1.0          # 模板引擎
pyyaml>=6.0            # 配置檔案
python-dotenv>=1.0.0   # 環境變數
```

#### 前端依賴
```
- Bootstrap 5.3+       # UI 框架
- jQuery 3.7+          # JavaScript 庫
- Chart.js 4.0+        # 圖表（統計頁面）
- Font Awesome 6.0+    # 圖示
```

### 內部依賴

#### 1. 現有系統整合
- **多保險預測模型**（multi_insurance_model.py）
  - 必須可正常載入和呼叫
  - 提供 predict_for_customer() 方法

- **資料結構**
  - 客戶 43 個特徵欄位定義
  - 保險產品清單（INSURANCE_PRODUCTS）

#### 2. 基礎設施
- **伺服器環境**
  - 作業系統：Linux/macOS（建議）或 Windows
  - Python 3.8+ 環境
  - 足夠的儲存空間（模型 + 資料 + 快取 > 10GB）

- **網路環境**
  - 本地網路穩定
  - 防火牆設定允許內部存取

#### 3. 團隊依賴
- **資料科學團隊**：提供模型說明和特徵解釋
- **業務團隊**：提供使用回饋和話術優化建議
- **IT 團隊**：協助部署和維護

### 依賴管理策略

1. **版本控制**
   - 使用 requirements.txt 鎖定套件版本
   - 使用 Git 管理程式碼版本

2. **風險緩解**
   - 關鍵依賴（Ollama）準備替代方案
   - 定期備份模型和資料
   - 建立測試環境驗證依賴更新

3. **文檔**
   - 詳細記錄所有依賴和版本
   - 提供安裝和設定指南
   - 建立故障排除文檔

---

## Technical Architecture

### 系統架構圖

```
┌─────────────────────────────────────────────────────────┐
│                     Web Browser                         │
│                  (網頁使用者介面)                          │
└────────────────────┬────────────────────────────────────┘
                     │ HTTPS
                     ▼
┌─────────────────────────────────────────────────────────┐
│                  Flask Web Server                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │   API Routes │  │  Controllers │  │   Services   │  │
│  │ /api/ollama/*│  │   業務邏輯    │  │   服務層     │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└────────────┬────────────────┬────────────────┬──────────┘
             │                │                │
             ▼                ▼                ▼
┌─────────────────┐  ┌──────────────┐  ┌─────────────────┐
│  Ollama Service │  │  ML Predictor│  │  Data Storage   │
│  (Qwen2.5:7b)  │  │  (XGBoost+DQN│  │  (SQLite/File)  │
│                 │  │              │  │                 │
│  - 客戶分析     │  │  - 購買預測  │  │  - 快取         │
│  - 話術生成     │  │  - 機率計算  │  │  - 歷史記錄     │
│  - 原因解釋     │  │              │  │  - 案例庫       │
└─────────────────┘  └──────────────┘  └─────────────────┘
```

### 資料流程

```
1. 用戶輸入客戶資料
    ↓
2. API 接收請求
    ↓
3. 呼叫 ML 模型預測 → 獲得推薦產品 + 機率
    ↓
4. 整合資料生成 Ollama 提示詞
    ↓
5. 呼叫 Ollama API → Qwen2.5:7b 分析
    ↓
6. 解析 Ollama 回應：
   - 購買原因
   - 痛點分析
   - 銷售話術
    ↓
7. 查詢相似案例
    ↓
8. 組合完整回應
    ↓
9. 返回前端展示
    ↓
10. 儲存記錄（快取 + 日誌）
```

### 技術棧

#### 後端
- **框架**：Flask 3.0
- **語言**：Python 3.8+
- **ML**：PyTorch, XGBoost, scikit-learn
- **LLM**：Ollama (Qwen2.5:7b)
- **資料庫**：SQLite（輕量級）
- **快取**：檔案系統快取

#### 前端
- **框架**：Bootstrap 5
- **語言**：HTML5, CSS3, JavaScript (ES6+)
- **庫**：jQuery, Chart.js
- **模板**：Jinja2

#### 開發工具
- **版本控制**：Git
- **程式碼格式化**：Black, Prettier
- **測試**：pytest, unittest
- **文檔**：Markdown, Sphinx (可選)

---

## Implementation Phases

### Phase 1: 基礎整合（Week 1-2）

**目標**：完成 Ollama 整合和核心分析功能

**任務**：
1. 建立專案結構和檔案組織
2. Ollama 服務連接和測試
3. 提示詞工程：設計核心提示模板
4. 實現單一客戶分析 API
5. 整合現有 ML 模型
6. 基本錯誤處理

**交付物**：
- 可運行的 Ollama 整合模組
- 單一客戶分析 API 端點
- 初步提示詞模板

### Phase 2: 網頁界面（Week 3-4）

**目標**：建立友善的網頁使用者介面

**任務**：
1. 前端頁面設計（Figma 或草圖）
2. 實現客戶資料輸入表單
3. 實現推薦結果展示頁面
4. 詳細分析面板開發
5. 載入狀態和錯誤提示
6. 響應式設計調整

**交付物**：
- 完整的網頁界面
- 友善的用戶體驗
- 操作指南

### Phase 3: 進階功能（Week 5）

**目標**：新增批量處理和相似案例功能

**任務**：
1. 批量處理 API 和頁面
2. 相似案例搜尋演算法
3. 統計儀表板（可選）
4. 快取機制實現
5. 效能優化

**交付物**：
- 批量處理功能
- 相似案例推薦
- 效能改善報告

### Phase 4: 測試與優化（Week 6）

**目標**：測試、優化、部署

**任務**：
1. 單元測試和整合測試
2. UAT（用戶驗收測試）
3. 提示詞優化（根據回饋）
4. 效能壓力測試
5. 文檔完善
6. 部署到生產環境
7. 用戶培訓

**交付物**：
- 測試報告
- 完整文檔
- 生產環境運行系統
- 培訓材料

---

## Risk Management

### 高風險項目

#### 風險 1: Ollama 效能不足
- **描述**：Qwen2.5:7b 在本地硬體上運行太慢
- **影響**：用戶體驗差，採用率低
- **可能性**：中
- **緩解措施**：
  - 使用 GPU 加速
  - 實現積極的快取策略
  - 提供「快速模式」（簡化提示詞）
  - 考慮使用更小的模型（Qwen2.5:3b）

#### 風險 2: 生成內容品質低
- **描述**：Ollama 生成的話術不符合業務需求
- **影響**：業務員不信任系統，不使用
- **可能性**：中高
- **緩解措施**：
  - 投入時間進行提示詞工程
  - 收集業務團隊回饋持續優化
  - 提供人工編輯功能
  - 建立品質評估機制

#### 風險 3: 硬體資源不足
- **描述**：伺服器硬體無法支援 1000+ 用戶
- **影響**：系統崩潰或回應極慢
- **可能性**：中
- **緩解措施**：
  - 事前硬體需求評估
  - 實現請求佇列系統
  - 限流和優先級控制
  - 準備擴展方案（多實例）

### 中風險項目

#### 風險 4: Ollama API 變更
- **描述**：Ollama 更新導致 API 不相容
- **影響**：系統無法運行
- **可能性**：低
- **緩解措施**：
  - 鎖定 Ollama 版本
  - 關注 Ollama 更新公告
  - 建立測試環境驗證新版本

#### 風險 5: 用戶採用率低
- **描述**：業務員不願意使用新系統
- **影響**：專案失敗
- **可能性**：中
- **緩解措施**：
  - 早期邀請業務團隊參與設計
  - 提供完善的培訓
  - 展示成功案例
  - 收集回饋快速迭代

#### 風險 6: 資料隱私疑慮
- **描述**：用戶擔心客戶資料安全
- **影響**：採用受阻
- **可能性**：低
- **緩解措施**：
  - 強調本地運行的安全性
  - 提供資料脫敏選項
  - 建立明確的資料使用政策

---

## Appendix

### A. 提示詞範例

#### 購買原因分析提示詞
```
你是一位資深保險分析師。根據以下客戶資訊和預測結果，分析為什麼這位客戶適合購買【產品名稱】。

客戶資訊：
- 年齡：40-50 歲
- 家庭：已婚，有子女
- 職業：中階管理
- 收入：45-75K
- 已購保險：汽車保險、火災保險

預測結果：
- 產品：人壽保險
- 購買機率：85%

請分析：
1. 這位客戶為什麼適合購買人壽保險？（從家庭責任、風險意識、財務規劃角度）
2. 客戶的核心痛點是什麼？（列出 3-5 個）
3. 客戶的心理動機是什麼？

請用繁體中文回答，語氣專業但易懂。
```

#### 銷售話術生成提示詞
```
你是一位頂尖的保險銷售教練。根據以下客戶特徵和分析，為業務員設計一套銷售話術。

客戶特徵：【同上】
痛點分析：【從上一步獲得】

請提供：
1. 開場白（30 秒內吸引注意）
2. 3 個核心說服點（針對客戶痛點）
3. 應對異議的話術（「太貴了」、「再考慮看看」）
4. 結案技巧

要求：
- 語氣親和但專業
- 避免過度推銷
- 強調客戶利益
- 使用繁體中文
```

### B. 資料庫結構

#### 分析歷史表（analysis_history）
```sql
CREATE TABLE analysis_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    customer_id TEXT,
    customer_data TEXT,  -- JSON
    prediction_result TEXT,  -- JSON
    ollama_response TEXT,  -- JSON
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 快取表（cache）
```sql
CREATE TABLE cache (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cache_key TEXT UNIQUE,
    cache_value TEXT,  -- JSON
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP
);
```

#### 成功案例表（success_cases）
```sql
CREATE TABLE success_cases (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    customer_profile TEXT,  -- JSON (脫敏)
    insurance_product TEXT,
    success_rate REAL,
    sales_strategy TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### C. 配置檔案範例（config.yaml）

```yaml
# Ollama 配置
ollama:
  base_url: "http://localhost:11434"
  model: "qwen2.5:7b"
  timeout: 60
  temperature: 0.7
  top_p: 0.9

# ML 模型配置
ml_model:
  path: "multi_insurance_model.pkl"
  threshold: 0.3

# 快取配置
cache:
  enabled: true
  ttl: 3600  # 1 小時
  max_size: 1000

# API 配置
api:
  host: "0.0.0.0"
  port: 5000
  debug: false

# 日誌配置
logging:
  level: "INFO"
  file: "logs/app.log"
  max_size: 10485760  # 10MB
  backup_count: 5
```

### D. 測試計劃

#### 單元測試
- Ollama 服務連接測試
- ML 模型載入測試
- 提示詞生成測試
- API 端點測試
- 快取機制測試

#### 整合測試
- 端到端分析流程測試
- 批量處理測試
- 相似案例搜尋測試
- 錯誤處理測試

#### 效能測試
- 並發用戶測試（100, 500, 1000）
- 回應時間測試
- 記憶體使用測試
- CPU 負載測試

#### UAT 測試
- 業務員實際使用測試
- 話術品質評估
- 易用性測試
- 回饋收集

---

## Glossary

- **Ollama**：開源 LLM 運行平台，可在本地運行大型語言模型
- **Qwen2.5:7b**：阿里巴巴開發的 70 億參數中文語言模型
- **LLM**：Large Language Model，大型語言模型
- **提示詞（Prompt）**：輸入給 LLM 的指令和上下文
- **DQN**：Deep Q-Network，深度 Q 網絡
- **XGBoost**：梯度提升決策樹演算法
- **成交率**：成功銷售的比例
- **痛點**：客戶的問題或需求
- **UAT**：User Acceptance Testing，用戶驗收測試

---

## Document Control

- **版本**：1.0
- **建立日期**：2025-10-16
- **作者**：Product Manager
- **最後更新**：2025-10-16
- **審核者**：待定
- **核准者**：待定

---

## Next Steps

1. **PRD 審核**：提交給相關利害關係人審核
2. **技術評估**：技術團隊評估可行性和工作量
3. **資源分配**：確認開發人員和時間排程
4. **環境準備**：設定 Ollama 環境和測試硬體
5. **開始開發**：執行 Phase 1 任務

**建議後續指令**：
```bash
/pm:prd-parse ollama-insurance-recommender
```

這會從 PRD 生成實作 Epic，進入開發階段。
