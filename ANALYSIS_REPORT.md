# 保險預測分析報告
## COIL 2000 Insurance Company Benchmark

---

## 📊 執行摘要

本分析針對荷蘭保險公司的客戶數據進行預測建模，目標是**預測哪些客戶會購買移動房屋保險（CARAVAN）**。

### 關鍵成果
- **最佳模型**: Gradient Boosting
- **準確率**: 93.90%
- **ROC-AUC**: 0.7192
- **資料集**: 5,822 筆訓練數據，4,000 筆測試數據

---

## 📁 數據概覽

### 數據集結構
- **訓練數據**: 5,822 筆客戶記錄
- **評估數據**: 4,000 筆客戶記錄
- **特徵數量**: 86 個屬性
  - 社會人口統計數據 (屬性 1-43)
  - 產品擁有情況 (屬性 44-86)

### 目標變數分佈
- **類別 0** (未購買): 5,474 筆 (94.02%)
- **類別 1** (已購買): 348 筆 (5.98%)

**⚠️ 類別不平衡問題**: 這是一個高度不平衡的分類問題，正樣本僅佔約 6%。

---

## 🔍 特徵分析

### 與目標最相關的前 10 個特徵

| 排名 | 特徵 | 相關係數 | 描述 |
|------|------|----------|------|
| 1 | PPERSAUT | 0.1509 | 汽車保險貢獻 |
| 2 | APERSAUT | 0.1442 | 汽車保單數量 |
| 3 | APLEZIER | 0.1057 | 船舶保單數量 |
| 4 | PWAPART | 0.0965 | 私人第三方保險貢獻 |
| 5 | MKOOPKLA | 0.0959 | 購買力等級 |
| 6 | PBRAND | 0.0944 | 火災保險貢獻 |
| 7 | PPLEZIER | 0.0914 | 船舶保險貢獻 |
| 8 | MINKGEM | 0.0902 | 平均收入 |
| 9 | AWAPART | 0.0894 | 私人第三方保險數量 |
| 10 | MOPLHOOG | 0.0846 | 高學歷程度 |

### 負相關特徵（前 5）

| 特徵 | 相關係數 | 描述 |
|------|----------|------|
| MOPLLAAG | -0.0906 | 低學歷程度 |
| MINKM30 | -0.0798 | 收入 < 30,000 |
| MHHUUR | -0.0791 | 租房 |
| MAUT0 | -0.0765 | 無車 |
| MOSTYPE | -0.0694 | 客戶子類型 |

**洞察**:
- 擁有汽車保險和船舶保險的客戶更傾向購買移動房屋保險
- 高收入、高學歷、擁有房產的客戶購買意願較高
- 低收入、租房、無車的客戶購買意願較低

---

## 🤖 模型比較

### 模型性能總結

| 模型 | 訓練準確率 | 驗證準確率 | ROC-AUC |
|------|-----------|-----------|---------|
| Logistic Regression | 94.01% | 93.56% | 0.7464 |
| Decision Tree | 99.27% | 90.47% | 0.5639 |
| Random Forest | 99.27% | 92.88% | 0.7130 |
| **Gradient Boosting** | **94.67%** | **93.82%** | **0.7794** |
| Naive Bayes | 11.98% | 12.02% | 0.6820 |

### 最佳模型: Gradient Boosting

#### 驗證集表現
```
              precision    recall  f1-score   support
           0       0.94      1.00      0.97      1095
           1       0.25      0.01      0.03        70
```

#### 測試集表現
```
              precision    recall  f1-score   support
           0       0.94      1.00      0.97      3762
           1       0.33      0.03      0.05       238
```

#### 混淆矩陣（測試集）
```
實際 \ 預測    0      1
    0       3750    12
    1        232     6
```

**性能指標**:
- 準確率: 93.90%
- ROC-AUC: 0.7192
- 精確率 (類別 1): 0.33
- 召回率 (類別 1): 0.03

---

## 🎯 特徵重要性分析

### 前 20 個最重要特徵

| 排名 | 特徵 | 重要性 | 類別 |
|------|------|--------|------|
| 1 | PPERSAUT | 0.1757 | 保險產品 |
| 2 | PPLEZIER | 0.0796 | 保險產品 |
| 3 | PBRAND | 0.0587 | 保險產品 |
| 4 | APLEZIER | 0.0365 | 保險產品 |
| 5 | MINKGEM | 0.0325 | 收入 |
| 6 | ALEVEN | 0.0317 | 保險產品 |
| 7 | MOPLLAAG | 0.0305 | 教育 |
| 8 | MOPLHOOG | 0.0299 | 教育 |
| 9 | MKOOPKLA | 0.0297 | 購買力 |
| 10 | MBERHOOG | 0.0289 | 職業 |
| 11 | MBERARBG | 0.0263 | 職業 |
| 12 | MBERMIDD | 0.0255 | 職業 |
| 13 | MINK7512 | 0.0224 | 收入 |
| 14 | PWAPART | 0.0206 | 保險產品 |
| 15 | PWAOREG | 0.0201 | 保險產品 |
| 16 | MGODGE | 0.0201 | 宗教 |
| 17 | MBERARBO | 0.0190 | 職業 |
| 18 | MGODOV | 0.0169 | 宗教 |
| 19 | MGODPR | 0.0163 | 宗教 |
| 20 | MBERBOER | 0.0160 | 職業 |

**關鍵發現**:
- **汽車保險貢獻 (PPERSAUT)** 是最重要的預測因子 (17.57%)
- 保險產品相關特徵佔據主導地位
- 收入、教育、職業等社會經濟指標也很重要

---

## 📈 模型評估

### 優勢
✅ 高準確率 (93.90%)
✅ 優秀的 ROC-AUC (0.7192)
✅ 對負樣本的預測非常準確 (recall = 1.00)
✅ 模型穩定，訓練集和測試集性能一致

### 挑戰
⚠️ **類別不平衡問題**:
- 正樣本召回率極低 (3%)
- 模型傾向於預測為負樣本
- 僅識別出 6 個真正的購買者（共 238 個）

⚠️ **精確率問題**:
- 正樣本精確率僅 33%
- 意味著有 2/3 的正預測是錯誤的

### 商業影響
- **保守預測**: 模型非常保守，只在高度確信時才預測為購買
- **成本考量**: 適合希望避免誤報的場景（如直接郵寄成本高昂）
- **機會損失**: 會錯過大量潛在客戶

---

## 🔧 改進建議

### 1. 處理類別不平衡
- **過採樣**: 使用 SMOTE 增加正樣本
- **欠採樣**: 減少負樣本數量
- **權重調整**: 給予正樣本更高的權重
- **閾值調整**: 降低分類閾值以提高召回率

### 2. 特徵工程
- 創建交互特徵（如收入 × 教育）
- 特徵選擇以減少噪音
- 多項式特徵轉換
- 聚類特徵（客戶分群）

### 3. 模型優化
- **超參數調優**: GridSearchCV 或 RandomizedSearchCV
- **集成方法**: Stacking 或 Voting Classifier
- **專門算法**: XGBoost, LightGBM, CatBoost
- **神經網絡**: 嘗試深度學習方法

### 4. 評估指標調整
- 使用 F1-score 而非準確率
- 考慮業務成本函數
- PR-AUC 可能比 ROC-AUC 更合適
- 自定義評分函數

### 5. 數據增強
- 收集更多正樣本數據
- 時間序列分析（客戶行為變化）
- 外部數據源整合
- 專家知識注入

---

## 💼 商業應用建議

### 目標客戶畫像
基於特徵重要性和相關性分析，最有可能購買移動房屋保險的客戶特徵：

1. **已擁有其他保險產品**
   - 汽車保險 (PPERSAUT, APERSAUT)
   - 船舶保險 (PPLEZIER, APLEZIER)
   - 火災保險 (PBRAND)

2. **社會經濟地位較高**
   - 高收入 (MINKGEM, MINK7512)
   - 高學歷 (MOPLHOOG)
   - 高購買力 (MKOOPKLA)
   - 房屋所有者 (MHKOOP)

3. **家庭狀況**
   - 已婚 (MRELGE)
   - 擁有汽車 (MAUT1)

### 營銷策略
1. **交叉銷售**: 向現有汽車保險和船舶保險客戶推廣
2. **高價值客戶**: 優先接觸高收入、高學歷客戶
3. **產品捆綁**: 提供移動房屋保險與其他保險的優惠組合
4. **精準營銷**: 使用模型預測概率排序，優先接觸高分客戶

### 成本效益分析
- **當前模型**: 極高精確度，適合有限預算的精準營銷
- **改進模型**: 提高召回率可增加覆蓋面，但需要更大的營銷預算
- **建議**: 根據客戶獲取成本 (CAC) 和客戶終身價值 (LTV) 調整閾值

---

## 📦 輸出文件

1. **insurance_prediction_analysis.py** - 完整的分析腳本
2. **insurance_predictions.csv** - 測試集預測結果
3. **insurance_prediction_analysis.png** - 可視化圖表
4. **ANALYSIS_REPORT.md** - 本報告

---

## 🎓 技術細節

### 使用的技術棧
- **Python 3.x**
- **pandas** - 數據處理
- **numpy** - 數值計算
- **scikit-learn** - 機器學習
- **matplotlib & seaborn** - 可視化

### 數據預處理
- StandardScaler 標準化
- 訓練/驗證集分割 (80/20)
- 保持類別比例的分層抽樣

### 模型訓練
- 5 種不同算法比較
- 交叉驗證
- ROC-AUC 作為主要評估指標

---

## 📞 結論

本分析成功建立了一個準確率達 93.90%、ROC-AUC 為 0.7192 的保險購買預測模型。雖然模型在整體準確率上表現優異，但由於類別不平衡問題，對少數類（購買者）的識別能力有限。

**下一步行動**:
1. 實施類別不平衡處理技術
2. 進行超參數優化
3. 嘗試更先進的集成方法
4. 根據業務目標調整分類閾值
5. 部署模型並持續監控性能

---

*報告生成時間: 2025-10-09*
*分析工具: Python + Scikit-learn*
*數據來源: COIL 2000 Challenge Dataset*
